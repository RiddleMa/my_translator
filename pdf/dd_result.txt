深度学习鉴别转移性乳腺癌
王Dayong Aditya斯拉(cid:63)Rishab Gargeya Humayun Irshad安德鲁·H贝克贝斯以色列女执事医疗中心,哈佛医学院(cid:63)做成,麻省理工学院
{ dwang5,hirshad,abeck2 } @bidmc.harvard.edu khosla@csail.mit.edu rishab.gargeya@gmail.com
摘要
生物医学成像国际研讨会(位ISBI)举行了隆重的挑战来评估计算系统的自动检测转移性乳腺癌前哨淋巴结活检的全部幻灯片图像。我们队赢得了比赛的大挑战,获得一个接受者操作曲线下面积(AUC)0.925为整个幻灯片图像分类的任务和肿瘤定位任务的得分为0.7051分。
病理学家独立审查相同的图像,获得整个幻灯片图像分类AUC 0.966和肿瘤定位得分为0.733分。结合我们的深度学习系统的预测与人类病理学家的诊断病理学家的AUC增加到0.995,代表人类错误率减少约85%。这些结果证明使用深度学习的力量产生显著改善病理诊断的准确性。
1。介绍
病理学的医学专业是负责提供明确的疾病诊断指导病人治疗和管理决策[4]。标准化的、准确和可再生的推进精密医学病理诊断是必不可少的。自19世纪中叶以来,病理学家所使用的主要工具,使诊断一直是显微镜[1]。显微图像的定性视觉分析的局限性包括缺乏标准化、诊断错误,和手动评估所需的重要认知负荷数以百万计的细胞在数以百计的幻灯片在一个典型的病理学家的工作日[7]15日17日。因此,在过去的几十年里有了越来越浓的兴趣发展计算方法协助在病理显微图像的分析[9 8]。
从2015年10月到2016年4月,国际研讨会上生物医学成像(位ISBI)举行Camelyon挑战赛2016(Camelyon16)来识别topperforming计算的任务自动图像分析系统检测数字整张图片的转移性乳腺癌前哨淋巴结biopsies1(WSIs)。乳腺癌前哨淋巴结的评估是一个重要的组成部分,美国癌症联合委员会的乳腺癌TNM分期系统,一个前哨淋巴结阳性患者的转移性癌症病理TNM阶段将收到一个高于为前哨淋巴结转移阴性患者[6],经常导致更积极的临床管理,包括腋窝淋巴结清扫后(13、14)。
手动前哨淋巴结的病理检查是耗时和费力,特别是在案件的淋巴结阴性癌症或只包含小病灶的转移性癌症。许多中心实现了与免疫组织化学检测前哨淋巴结pancytokeratins[5],蛋白表达在乳腺癌细胞和通常不存在于淋巴结,改善癌症转移的敏感性检测。然而,限制pancytokeratin immunohiostochemistry前哨淋巴结的测试包括:增加成本,增加时间来准备幻灯片,幻灯片所需数量的增加病理检查。进一步,即使immunohistochemistry-stained幻灯片,小癌症转移的识别可以是乏味的和不准确的。
计算机辅助图像分析系统开发来帮助小转移病灶的检测从pancytokeratin-stained免疫组织化学的幻灯片前哨淋巴结(22);然而,这些系统并不是用于临床。因此,开发有效的和成本有效的前哨淋巴结的评估方法仍是一个活跃的研究领域[11],会有价值一个高性能的系统,可以以低成本提高准确性和减少认知负荷。
在这里,我们提出一个基于深度学习方法识别癌症转移的乳腺癌前哨淋巴结的幻灯片图像。我们的方法使用数以百万计的培训补丁训练深卷积神经网络使歧视从normal-patches tumor-patches缀块的预测。然后我们总缀块的预测建立肿瘤概率的热图和执行后处理对这些的热图进行预测slide-based分类任务和tumor-localization任务。我们系统赢得了比赛2016 Camelyon大挑战,性能接近人类层次的准确性。最后,结合深入学习系统的预测与病理学家的解释产生显著减少病理学家的错误率。
2。数据集和评价指标
在本节中,我们描述比赛的组织者提供的Camelyon16数据集和评价指标等级的参与者。
2.1。Camelyon16数据集
Camelyon16数据集包含一个400整个幻灯片图片培训(WSIs)分为270和270进行测试。两个分裂包含样本两个机构(Radbound联华电子和联电乌特勒支)与表1中提供具体细节。
培训幻灯片的地面实况数据由一个病理学家的描述区域的转移性癌症在WSIs前哨淋巴结。提供的数据是在两种格式:XML文件包含顶点的位置标注轮廓的癌症转移和WSI二进制面具表明癌症转移的位置。
2.2。评价指标
提交的竞争进行评估以下两个指标:
•Slide-based评估:对性能指标,团队被认为在识别幻灯片包含转移和正常的幻灯片。竞争参与者提交的一个概率为每个测试幻灯片表明其预测包含癌症的可能性。比赛组织者测量了参与者的性能使用接收器算子下的面积(AUC)得分。
•Lesion-based评价:对于这个指标,参与者提交的概率和相应的(x,y)位置为每个预测WSI癌症病变。比赛组织者测量参与者的平均性能敏感性检测所有真正的癌症病变WSI 6假阳性利率:1 2 1,2,4,8每WSI假阳性。
3.方法
在本节中,我们描述我们的方法癌症转移检测。
3.1。图像预处理
图1:组织区域的可视化检测在图像预处理(第3.1节中描述)。发现组织区域用绿色突出了曲线。
减少计算时间和我们的分析集中在地区的幻灯片最有可能包含癌症转移,我们首先要确定组织WSI和排除背景中的空白。为了实现这一点,我们采用基于阈值的分割方法自动检测背景区域。特别是,我们首先将原始图像从RGB颜色空间到HSV颜色空间,然后在每个通道最优阈值计算使用大津算法[16],最后掩模图像生成结合H和S通道的面具。检测结果显示在图1中,组织区域用绿色突出显示的曲线。
根据检测结果,每WSI背景区域的平均比例为82%左右。
3.2。癌症转移检测框架
我们的癌症转移检测框架由patch-based分类阶段和一个heatmap-based后处理阶段,如图2中所示。
在模型训练过程中,patch-based分类阶段需要作为输入整个幻灯片图像和地面实况图像注释,指示的位置区域的每个WSI包含转移性癌症。我们随机抽取数以百万计的正面和负面的小块从培训WSIs的集合。如果小块位于肿瘤区域,这是一个肿瘤/积极的补丁和标有1,否则,它是一个正常的/消极的补丁,贴上0。后选择的积极和消极训练的例子,我们训练一个监督分类模型来区分这两个类的补丁,我们将所有的预测结果嵌入一个热图的形象。heatmap-based后处理阶段,我们使用肿瘤的热图概率计算slide-based评价和每个WSI lesion-based评价分数。
3.3。Patch-based分类阶段
在培训期间,这个阶段使用256 x256像素作为输入补丁信息社会世界峰会的首次从正面和负面的地区和火车一个分类模型来区分正面和负面的补丁。我们评估了四个著名的深入学习网络的性能架构分类任务:GoogLeNet[20],AlexNet[12],VGG16[19],一张脸面向深网络[21],如表2所示。两个深层网络(GoogLeNet和VGG16)达到最佳的patch-based分类性能。在我们的框架中,我们采用GoogLeNet作为深层网络结构,因为它通常比VGG16更快和更稳定。GoogLeNet由27层的网络结构和600万多个参数。
表2:不同深度模型的评价
在我们的实验中,我们评估一系列的放大的水平,包括40×20×10×,我们用40×放大获得最佳性能。我们只使用40×放大的实验结果报道Camelyon竞争。
后生成tumor-probability热图使用GoogLeNet整个训练数据集,我们注意到一个重要的错误是由于假阳性的比例从组织学分类模拟的癌症。改善模型性能在这些地区,我们从这些困难负区域提取额外的培训例子和再培训模型训练集丰富这些消极的补丁。
我们现在我们的结果在图3中。鉴于整个幻灯片图像(图3(a))和基于深度学习的分类模型,我们生成相应的肿瘤区域的热图(图3(b)),这突显出肿瘤区域。
图3:可视化检测的肿瘤区域。
3.4。后处理的肿瘤的热图和买主计算slide-based lesion-based概率
patch-based分类阶段完成后,我们生成一个肿瘤概率为每个WSI的热图。这些的热图,每个像素都包含一个值在0和1之间,表明像素包含肿瘤的概率。
我们现在执行后处理计算为每个热图slide-based和lesion-based分数。
3.4.1 Slide-based分类
slide-based分类任务,后处理需要作为输入每个WSI的热图和生产作为输出单一肿瘤整个WSI的概率。给定一个热图,我们从每个热图提取28几何和形态学特征,包括肿瘤区域的比例在整个组织区域,肿瘤之间的面积比周围地区和最小凸区域,平均预测的值,和肿瘤的最长轴区域。我们计算这些功能在肿瘤概率的热图所有培训的情况下,我们建立一个随机森林分类器来区分WSIs从负WSIs转移。测试用例,我们slide-based分类方法实现了AUC的0.925,这使得表现系统Camelyon slidebased分类任务的大挑战。
3.4.2 Lesion-based检测
lesion-based检测后处理,我们的目标是识别所有癌症病变在每个WSI公司与一些假阳性。为了达到这个目标,我们首先训练深模型(d - i)使用上面描述我们最初的训练数据集。然后火车第二个深模型(D-II)的训练集丰富tumor-adjacent消极的地区。这个模型(D-II)产生假阳性少于d - i,但降低灵敏度。在我们的框架中,我们首先阈值
热图由d - i在0.90,创建一个二进制的热图。然后我们确定肿瘤二元掩模内连接组件,我们使用中心点作为肿瘤位置为每个连接组件。肿瘤的概率估计在每一个这些(x,y)位置,我们把肿瘤的平均概率预测所产生的d - i和D-II每个连接组件。Camelyon16的评分指标被定义为平均灵敏度6预定义的假阳性:1/4、1/2、1,2,4,8帧/整个幻灯片图像。我们的系统取得了0.7051分,得分最高的在竞争和peek的得分(0.5761)高22%。
4所示。实验结果
4.1。评价结果从Camelyon16
在本节中,我们简要介绍Camelyon16组织者所产生的评估结果,这也可以在网站上2。
有两种评价Camelyon16:Slidebased评价和Lesion-based评估。我们就这两个两个具有挑战性的任务。
Slide-based评估:评估算法的优点包含转移和正常幻灯片幻灯片之间的差别。接受者操作特征(ROC)在滑动层面进行分析和测量用于比较算法的ROC曲线下面积(AUC)。我们提交的结果是基于该算法生成3.4.1节。如图4所示,AUC是0.9250。请注意,我们的算法比第二个最好的方法在执行假阳性率(玻璃钢)很低。
Lesion-based评估:Lesion-based评价,自由反应接受者操作特征(FROC)曲线。FROC曲线的定义是敏感性的情节和假阳性/图像的平均数量。我们提交的结果是基于该算法生成3.4.2节。如图5所示,我们可以做出两个观察:首先,病理学家并没有使任何假阳性预测;第二,当假阳性的平均数大于2,这意味着将会有两个假阳性警报在平均每个幻灯片,我们的表现(灵敏度)甚至比病理学家。
4.2。结合深入学习系统与人类病理学家
评价一流的深度学习系统对人类病理学家,Camelyon16组织者有病理学家检查测试图像中使用com请愿书。slide-based分类任务,人类病理学家实现了AUC 0.9664,反映出3.4%的错误率。当我们深入学习系统的预测结合的预测人类病理学家,AUC是提高到0.9948反映了错误率下降到0.52%。
5。讨论
在这里,我们提出一个基于深度学习系统自动检测整张图片的转移性癌前哨淋巴结。我们的系统的主要方面包括:浓缩的训练集的补丁地区正常的淋巴结系统最初mis-classifying癌症;使用state-of-theart深度学习模型架构;和精心设计slide-based后处理方法的分类和lesion-based检测任务。
从历史上看,组织病理学方法在数字病理图像分析主要集中在低阶的图像分析任务(例如,颜色正常化,核分割和特征提取),其次是建设分类模型使用经典的机器学习方法,包括:支持向量机,和随机森林回归。通常情况下,这些算法采取作为输入相对较小的图像特征(十)的顺序(9、10)。在这个框架的基础上,适度自动化提取方法已经开发出来的高维图像特征集(成千上万的)从组织病理学图像其次是相对简单的结构,使用方法为线性分类模型降维,如稀疏回归[2]。
自2012年以来,基于深度学习方法一直显示最佳性能主要计算机视觉的比赛,比如ImageNet大规模视觉识别竞争(ILSVRC)[18]。
基于深度学习方法最近也有望应用于病理学。一个团队的研究小组使用的Juergen。施密德胡贝尔表示深learningbased方法赢得ICPR 2012年和2013年MICCAI挑战集中在算法发展为有丝分裂图检测[3]。与机器学习方法的类型历史上用于数字病理,在深度上优于方法往往是没有对象离散human-directed步骤检测、对象分割和特征提取。相反,深入学习算法只采取作为输入图像和图像标签(例如,1或0)和学习一组高维、复杂的模型参数与监督不仅来自图像标签。
我们获胜的方法在Camelyon挑战赛2016利用27-layer深度网络体系结构和获得接近人类分类性能测试数据set.Importantly,由我们的深度学习系统的错误并没有很强的关联的错误由人类病理学家。因此,尽管病理学家独自目前仅优于我们的深度学习系统,结合深度学习和病理学家产生了主要的病理学家减少错误率,减少从3%到不到1%。更普遍的是,这些结果表明,将基于深度学习方法集成到工作流的诊断病理学家可以再现性,提高准确性和临床病理诊断的价值。
6。致谢
我们感谢所有Camelyon挑战赛2016组织者特别鸣谢领导协调员Babak Ehteshami Bejnordi。AK和AHB创始人PathAI公司。
参考文献
[1]e·h·Ackerknecht et al。Rudolf virchow:医生,政治家,人类学家。Rudolf Virchow:医生,政治家,人类学家。,1953年。1[2]a·h·贝克,a . r . Sangoi梁,r . j .马里内利t . O。
尼尔森·m·j . van de Vijver r·b·西m . van de Rijn和d·科勒。系统分析乳腺癌的形态揭示基质特性与生存相关。《科学—转化医学》3(108):108 ra113 - 108 ra113,108。5[3]d . c . Cires¸一个a Giusti。的l . m . Gambardella,j。施密德胡贝尔表示有丝分裂检测在乳腺癌组织学图像在医学影像计算与神经网络。
计算机辅助Intervention-MICCAI 2013年,页411 - 418。施普林格,2013年。5[4]r . s . Cotran诉Kumar,t·柯林斯和s·l·罗宾斯。罗宾斯疾病的病理基础。1999年。1[5]b . j . Czerniecki a . m .希夫l·s·卡兰f R。
施皮茨,Bedrosian,e . f .柯南特s . g .奥廖尔j .柏林,c . Helsabeck d l . Fraker et al。
免疫组织化学pancytokeratins提高灵敏度的前哨淋巴结活检在乳腺癌患者。癌症,85(5):1098 - 1103年,1999年。1[6]s b和c·c·康普顿边缘。美国癌症联合委员会:第七版与癌症分期的手册和tnm的未来。肿瘤外科的编年史,17(6):1471 - 1474年,1471年。1[7]j·g·爱尔摩之一通用龙腾说,p·a·卡尼b·m·盖勒·t·奥涅加,a . n . Tosteson H·d·纳尔逊·m . s .佩佩,k . H。
艾莉森,s . j . Schnitt et al .诊断一致性在Jama,病理学家解释乳房活检标本。
313(11):1122 - 1132年,1122年。1[8]f . Ghaznavi,a·埃文斯,a . Madabhushi和m·费尔德曼。
数码影像病理:张幻灯片成像。年度回顾病理:疾病的机制,8:331 - 359,2013。1[9]m . n . Gurcan l e。a .,a . Madabhushi n·m·Rajpoot和日元。组织病理学图像几个:一个回顾。生物医学工程、IEEE评论,2:147 - 171,2009。1、5[10]h . Irshad a . Veillard l .面粉糊,d . Racoceanu。核方法检测、分割和分类在数字组织病理学:reviewcurrent状态和未来的潜力。生物医学工程、IEEE评论,7:97 - 114,2014。5[11]于jaf和i . j . Bleiweiss。乳腺癌前哨淋巴结活检的进化的时尚吗?解剖病理学的进步,21(6):433 - 442年,433年。1[12]a . Krizhevsky Sutskever,和g·e·辛顿。
Imagenet与深卷积神经网络分类。
在f·佩雷拉,c . j . c . Burges l . Bottou和k·温伯格,编辑,神经信息处理系统25的进步,页1097 - 1105。Curran Associates Inc .,2012年。3[13]g·h·莱曼,a·e·朱利亚诺·m·r·索莫菲尔德a·b·本森d . c . Bodurka h . j . Burstein a·j·科克伦·h·S。
科迪,s . b .边缘Galper s,et al。美国临床肿瘤学会指南建议在早期乳腺癌前哨淋巴结活检。临床肿瘤学杂志,23(30):7703 - 7720年,7703年。1[14]g·h·莱曼,s > s . b .边缘,l·a·纽曼,R R。
特纳,d·l·韦弗,a·b·本森l . d . Bosserman h·J。
Burstein h·科迪,et al .早期乳腺癌患者前哨淋巴结活检:美国临床肿瘤学会临床实践指南更新。临床肿瘤学杂志》,32(13):1365 - 1383年,1365年。1[15]r e等。
错误减少外科病理学。
病理学和实验室医学档案,130(5):630 - 632年,630年。1[16]n .首先进行。灰度直方图的阈值选择方法。IEEE系统,人与控制论,9(1):62 - 66年,62年。2[17]s . s .拉布·d·m·Grzybicki j . e . Janosky r . j . Zarbo f。
迈耶、c·詹森和s·j·盖尔。临床影响和解剖病理学的频率在癌症诊断错误。
癌症,104(10):2205 - 2213年,2205年。1[18]o . Russakovsky j .邓h·苏j . Krause s Satheesh马,黄z,a . Karpathy a·斯拉·m·伯恩斯坦等。
Imagenet大规模视觉识别的挑战。
国际计算机视觉学报,115(3):211 - 252年,2015年。5[19]k . Simonyan Zisserman。
很深的卷积网络大规模图像识别。2014年,abs / 1409.1556。3[20]c . Szegedy w·刘,y,p . Sermanet里德,d . Anguelov d . Erhan诉Vanhoucke,拉比诺维奇。
去更深的旋转。2015年CVPR,2015。3[21]d . Wang c·奥托,a . k . Jain。面对大规模搜索:8000万画廊。2015。3[22]d·l·韦弗,d . n . Krag e·a·吗哪,t .足利·哈洛和k·d·鲍尔。比较pathologistdetected和自动计算机辅助图像分析检测在乳腺癌前哨淋巴结微转移。现代病理学,16(11):1159 - 1163年,2003年。1
