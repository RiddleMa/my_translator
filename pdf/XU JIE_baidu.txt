基于隐含特征和领域知识的青光眼深度学习诊断模型
易东柴阿，洪艳柳阿，Jie Xub
清华大学经济管理学院现代管理研究中心，北京，100084，中国北京眼科研究所，北京同仁眼科中心，北京同仁医院，首都医科大学，北京，100084，中国
摘要
青光眼是世界上导致失明的主要原因之一，目前还没有治愈的方法。但是，尽早检测出来是非常有意义的，因为早期的检测能够阻止视力的进一步丧失。尽管深层学习模型在自然图像分析中已经证明了它们的优点，但它们通常依赖于大型数据集来学习提取隐藏的特征，从而限制了其在难以获取数据的医学领域的应用。因此，用较少的数据设计用于疾病诊断的深层学习模型是有意义的和具有挑战性的。本文研究了如何利用深度学习模型将领域知识与视网膜眼底图像相结合进行青光眼自动诊断。领域知识包括对青光眼诊断有重要意义的措施和包含大量信息的图像的重要区域。为了充分利用这一领域知识，同时从图像中提取隐藏特征，我们设计了一个多分支神经网络（MB-NN）模型，并采用多种方法自动提取图像的重要区域并获得领域知识特征。我们对提出的模型在真实数据集上的有效性进行了评价，获得了0.9151的准确度，0.9233的灵敏度，0.9090的特异性，优于现有模型。
关键词：深层学习、疾病诊断、卷积神经网络、领域知识、青光眼诊断、医学图像分析
1。介绍
青光眼是世界上导致失明的主要原因之一，目前还没有治愈的方法。但是，尽早检测出来是非常有意义的，因为早期的检测能够阻止视力的进一步丧失。尽管深层学习模型在自然图像分析中已经证明了它们的优点，但它们通常依赖于大型数据集来学习提取隐藏的特征，从而限制了其在难以获取数据的医学领域的应用。因此，用较少的数据设计用于疾病诊断的深层学习模型是有意义的和具有挑战性的。本文研究了如何利用深度学习模型将领域知识与视网膜眼底图像相结合进行青光眼自动诊断。领域知识包括对青光眼诊断有重要意义的措施和包含大量信息的图像的重要区域。为了充分利用这一领域知识，同时从图像中提取隐藏特征，我们设计了一个多分支神经网络（MB-NN）模型，并采用多种方法自动提取图像的重要区域并获得领域知识特征。我们对提出的模型在真实数据集上的有效性进行了评价，获得了0.9151的准确度，0.9233的灵敏度，0.9090的特异性，优于现有模型。
该疾病具有一些常见的症状，包括高眼压、视神经损伤、大杯盘比和视力丧失[5，6]。目前，还没有治愈青光眼的方法，但是早期检测和治疗对于预防更严重的后果（例如失明）是必不可少的。通过早期检测，可以进行手术来控制眼压并避免视力进一步恶化[7]。
在医院里，像视网膜图像或眼底照片这样的图像通常是人工拍摄和解释来诊断青光眼。由于人工图像判读昂贵且容易出错，青光眼自动检测是一个有趣且有意义的研究课题[7]。许多学者采用计算机视觉算法进行诊断。这些研究的主流可以分为两类。在这些方法中，研究人员手动设计特征，例如基于能量的特征[8]、局部构造模式(LCP)特征[9]和高阶谱(HOS)特征[10]。
然后基于这些特征建立分类器，用于诊断。第二类方法提取医疗措施，例如用于诊断的杯盘比[7]。这些特征是基于分割过程计算的，其中手动设计的特征用于分割青光眼相关组织，例如视盘和视杯[7]。
尽管已经为青光眼诊断做了许多研究，但是手动设计特征需要大量的工程技术和领域专门知识[11]。此外，这些特性可能过度简化了问题并且是临时的，因为即使专家也可能省略一些重要的隐藏模式。因此，深层学习模型已被引入青光眼诊断[16，17]，该模型具有从高维数据中捕获复杂隐藏模式并在许多研究中显示出优越性的优点[11，12，13，14，15]。这些研究也可以分为两个流。第一类研究以整个视网膜图像为输入，完全依赖于诸如卷积神经网络（CNN）之类的深层学习模型从图像中提取特征用于青光眼诊断[16，17]。对于第二种类型，它利用领域知识和医学措施，如杯盘比率进行诊断。采用深度学习模型分割视网膜图像中的组织，以便计算这些度量[18，19]。这些研究取得了比传统计算机视觉方法更好的结果，并且显示了将深度学习用于青光眼诊断的有意义的探索。然而，第一类研究仅仅从数据中提取特征，这使得它依赖于大型数据集来学习有用的特征。此外，这些模型省略了领域知识，并且不能输出医生非常关心的医疗措施（例如，杯盘比），因为这些措施可以给出诊断结果的原因。对于第二种类型，尽管使用了领域知识，但是诊断完全依赖于医学特征（例如，杯盘比）。可从深度学习模型中学习的有用的隐藏特征被忽略了。
本文设计了一个多分支神经网络模型，利用领域知识和自动学习的隐藏特征进行青光眼诊断。领域知识有两种方式。首先，该模型不仅仅以每个全局图像作为输入，还包含一个局部重要区域。其次，不仅要考虑眼压、视力、年龄和症状等结构特征，还要考虑从图像上提取的特征，如杯盘比、视网膜神经层缺损、乳头周围萎缩、视盘大小和视杯大小等。利用ASAL，下颞部。
通过这种方式，我们结合了青光眼的领域知识，并在一定程度上结合了两种青光眼自动检测方法。在传统的CNN模型的基础上，设计了一种新的深层学习模型，称为多分支神经网络模型，将各相关分量组合在一起。该模型的性能优于经典的CNN和传统的计算机视觉方法。我们提出的模型可以帮助医生更快、更准确地做出诊断。从这个意义上说，不像其他深层学习模型，它像黑匣子，只告诉你是或不是，我们的模型还可以产生一些措施（例如，杯盘比，RNFLD和PBA），这些措施有助于医生理解结果和作出诊断决策。
本文的创新之处在于提出一种新的深度学习模型，将领域知识和从深度学习模型中学习的特征结合起来，以获得更好的诊断结果。为了利用领域知识，我们提出了一个自动提取领域知识特征和信息区域的框架。除了常用的杯盘比等特征外，我们还建议提取RNFLD、PPA特征用于青光眼诊断。
论文的其余部分按如下方式组织。在第2节中，我们对相关工作进行了回顾。第3节详细介绍了我们的模型。第4节描述了所使用的数据。然后，我们在第五部分报告实验设置和结果，在第六部分讨论实验。我们在第7节结束了论文。
2。相关工作
2.1。应用计算机视觉方法诊断青光眼
许多研究人员研究了如何基于视网膜图像自动诊断青光眼。早期的研究通常使用传统的计算机视觉方法来提取手动设计的特征。这些研究可分为两类。
第一类方法是基于非分割的方法，它设计各种特征，如局部构造模式(LCP)特征[9]、GIST描述符特征[12]、熵特征[20]、基于能量的特征[8,21]、分形维特征[22]、高阶谱等。a(HOS)特征[10,23,24]、相关熵特征[25]、快速傅立叶变换(FFT)特征[26]和基于小波的特征[24,27]。阿查亚等。[23]根据视网膜图像计算纹理和HOS特征，训练SVM分类器预测青光眼。穆基亚等。
[24]提出了一种利用HOS和离散小波变换特征区分青光眼正常病例的自动诊断系统。杜阿等。
[27]基于基于小波的能量特征训练分类器，这些能量特征是从各种小波中计算出来的。雅达夫等。
[28]计算视杯周围区域的纹理特征，并根据这些特征训练神经网络分类器，用于青光眼分类。
第二种是基于分割的方法，该方法基于分割过程生成用于青光眼诊断的常见措施，其中研究人员设计特征以分割重要区域，如杯和盘。纳亚克等人。[29]提出了通过形态学操作分割视盘和视杯的方法，以计算用于青光眼诊断的视盘比值。Babu和Shenbagadevi[30]提出了利用小波变换后的绿平面图像上的模糊c均值聚类来计算铜盘比。Lee et al。_31_检测出RNFLD患者视盘周围强度降低，这也是青光眼的常见指标。基于分段的方法通常需要检测光盘rst，这是吸引众多学者的另一个研究课题。乔杜里等。[32]提出通过阈值化强度值低于一定水平的像素来检测光盘区域。拉隆德等。
[33]提出了一种将基于Hausdor的模板匹配技术和金字塔分解相结合的光盘检测方法，用于大规模目标跟踪。
虽然这些研究取得了良好的结果，并表明了自动青光眼诊断的可行性，但它们严重依赖于人工设计的特征，这花费了大量的能量和资源。而且，由于外观的多样性，这些特性通常很难设计和特别设计。这个问题可以通过深度学习模型来解决。
2.2。应用深层学习模型诊断青光眼
深度学习模型具有从高维数据中自动学习复杂隐藏模式的能力[11]。自从AlexNet在2012[12]被提出以来，许多强大的模型如VGG16网[13]、GoogLeNet[14]和Deep..Net[15]被提出，并显示出它们在图像分类方面优于传统方法。此外，深度学习模型在诸如目标检测[34]、语义分割[35]、自然语言处理[36]和语音识别[37]等广泛任务中也取得了最先进的性能。
使用深层学习模型诊断青光眼的研究可分为两类。rst型通过深层学习模型直接输出青光眼诊断结果。陈等人。
[16]在ORIGA和SCES数据集上训练CNN进行青光眼诊断，得到比现有算法更好的结果。拉哈文德拉等。〔17〕提出了青光眼诊断的十八层美国有线电视新闻网。这种类型的工作纯粹基于数据提取特征，这使得它依赖于大型数据集来学习有用的特征。此外，领域知识被忽视，医疗措施不可用，这可以补充来自深层学习模型的特征，并且可以给出诊断结果的原因。
第二类研究使用深层学习模型来分割青光眼相关组织，如视盘和视杯，然后计算用于诊断的医疗措施（例如，杯盘比）[18，19]。齐利等人。
[18]提出利用基于CNN结构的集成学习从视网膜图像中分割视杯和视盘，并计算用于青光眼诊断的视杯与视盘的比率。虽然这种类型的工作提取了一些医学特征（例如，杯盘比），但仍有一些其他未开发的特征（例如，PPA大小、RNFLD），这些特征可以进一步改善诊断。此外，虽然采用深层学习特征进行分割，但这些有用的特征在诊断时被省略。
此外，现有的深层学习工作基于仅包括青光眼病例和正常病例的数据集来评估他们建议的方法，而在实际情况中，医生需要区分青光眼与所有其他眼病，这更难实现高精度。因此，需要进一步研究深层学习模型在青光眼与非青光眼鉴别中的能力。
本文旨在解决这些问题，并提出利用深层学习模型和领域知识的模型。我们在医院收集的各种眼科疾病病例的数据集上进行实验，以评估深层学习模型在青光眼诊断中的性能。
三。多分支神经网络模型
青光眼具有杯盘比大、RNFLD、PPA等常见临床表现。测量杯盘比是光学杯区域的直径与光盘直径的比率[38]。在视网膜图像中，视盘是轻的垂直椭圆形，并且视杯是位于视盘中心的白色杯状区域[38]。这两个区域如图1所示。正常杯对盘比率在0.3和0.5之间。当比值在0.5以上时，很可能发生青光眼[5 ]。与正常人相比，青光眼和近视患者通常有PPA，它是视盘周围的绿色区域，如图1所示。RNFLD，从视盘开始的大致楔形区域，是青光眼图像的另一个主要特征[6，39]。在图1中，图像（A）是青光眼图像，图像（B）是正常情况。
正如我们所看到的，图像（A）具有较大的杯对盘比，约为0.8。
同时，PPA和RNFLD也出现在青光眼的图像中。
圆盘区域是覆盖视盘和杯状物的最小矩形盒。这个地区虽然相对较小，但比其他地区含有更多的歧视性信息。同时，我们不能放弃其他地区，因为他们也包含有用的信息，如脉管系统出血〔1〕。这启发我们设计一个分析整个图像的模型，同时要更加关注视盘区域。
图1：青光眼与正常病例的比较
为了利用领域知识特征，同时对椎间盘区域及整个图像进行分析，我们提出了用于青光眼自动检测的多分支神经网络模型。图2显示了所提出的模型的整个框架。在此框架下，青光眼诊断以完全自动化的方式实现。rst分支以整个图像作为输入，并通过CNN提取特征。为了得到第二分支的输入，我们使用快速RCNN来获得光盘区域。然后利用美国有线电视新闻网提取局部重要特征。对于第三个分支，我们使用全卷积网络（FCN）模型对圆盘区域、杯形区域和PPA区域进行分割，然后计算度量。我们还从CNN输入RNFLD，并将病例报告的非图像特征输入到第三分支。
3.1。视盘区域提取
为了获得视盘区域，我们需要将其从视网膜图像分割出来。可以使用OB检测技术来实现这一点。我们没有选择传统的方法[32，33]，而是采用深度学习模型，Faster-RCNN[34]，来完成这个任务。更快的RCNN是2015（34）中提出的一种著名的OB检测方法。它引入了区域建议网络（RPN）来生成高质量的区域建议。RPN模型是与检测网络共享全图像卷积特征的CNN[34]。
快速RCNN是目前目标检测领域中最先进的方法之一。它通过利用GPU进行区域建议来加速运行时间，并且可以实现实时对象检测目标[34]。
图2：我们提出的模型的框架
3.2。领域知识特征
3.2.1图像特征
我们在上部、鼻部、下部和颞部设计了包括杯盘比、PPA、RNFLD、盘和杯大小的特征。
为了获得光盘、光杯和PPA的特征值，我们需要对这些区域进行分割。我们采用了FCN[40]，它是一个强大的图像分割的深度学习框架。FCN包括两个部分：下采样和上采样，分别用于提取图像特征和为每个类输出像素标签[40]。
为了得到杯盘比，我们通过两个面积大小的比值的根来估计值。大小是由该区域中像素的数量来测量的。
对于视盘和视杯大小，我们将视盘和视杯区域分为上、鼻、下和颞部，然后得到每个部分的视杯大小和视杯大小作为特征。图3显示了上、鼻、下和颞部。
图3：上、鼻、下、颞部
对于PPA度量，我们使用PPA区域的大小作为特性，称为PPA大小。
对于RNFLD特性，我们使用CNN来检测视网膜图像中是否有RNFLD。我们把这个特性叫做RNFLD。
我们总结了表1中的这些特征。
表1：基于领域知识的图像特征设计
3.2.2.非图像特征
还提取了年龄、眼压、视力和症状等特征。为了简单起见，我们认为它们是非图像特征。
对于年龄、眼压和视力特征，我们只使用病例报告的原始数值。
对于症状，我们处理患者投诉文本，并提取二元特征，如“视力下降”、“眼睛受伤”、“眼睛肿胀”、“视力模糊”和“头痛”，如表2所示。
表2：非图像特征
我们通过设计一个提取每个症状特征的过程来处理投诉文本。如果投诉文本包括症状，则相应的值为1。否则，它是0。提取“头痛”特征的过程如下面的示例所示。
1：从投诉中提取“头痛”特征
对于症状特征，我们以相似的方式处理它们。最后，我们产生25个变量，指示各种症状。
3.3。多分支神经网络
为了同时分析整个图像、光盘区域和区域特征，我们设计了一个多分支神经网络模型。该模型的第一分支和第二分支分别是CNN，用于分析整个图像和盘区域图像，第三分支是全连接的前向神经网络，用于处理领域知识特征。然后，我们将这些分支的输出连接起来，并添加两个完全连接的层（FC层）用于nal预测。模型的结构如图4所示。“C1：特征映射32，5*5*3”表示在rst卷积层中有32个大小为5*5*3的核。“FC（128）”是指具有128个节点的全连通层。
3.3.1模型分支
这两个分支都是美国有线电视新闻网模型。每个CNN模型包含卷积层，该卷积层对输入应用卷积操作，然后执行最大池操作。第二个分支模型中的内核大小为3*3，因为小的内核大小可以减少参数，并且避免过量[41]。另一方面，对于rst分支CNN模型，在rst两个卷积层中核的大小是5*5，这是一个相对较大的接收eld，以便它能够提取更多的全局信息。我们还添加了辍学层，其中每个节点都是概率为0.5的“辍学”网络。Max-pooling是一种非线性下采样技术，可以减少网络中的参数数量和计算量，因此可以控制过采样[12]。池操作中的步长大小是（2，2），因为较大的步长会导致太多的信息丢失。在我们设计的网络中，使用了Rectied线性单元（ReLU）激活函数，其性能优于sigmoid函数[19]。
第三个分支是完全连接的神经网络，用于处理包括上述图像特征和非图像特征的领域知识特征。我们还使用Relu激活功能在这一层。
图4：多分支模型的结构
3.3.2合并层
在每个分支的顶部，添加一个合并层以合并从各个分支提取的特征。来自每个分支的特征被连接和重组为向量，并且合并层连接这三个向量以形成新的向量xmerge，如方程(1)所示，
（1）
其中，x1、x2和x3分别表示rst、第二和第三分支的输出。
3.3.3完全连通层与Logistic回归分类
在合并层的顶部添加两个完全连接的层，并且使用合并的向量作为输入。全连接层也具有Relu作为激活函数。我们采用辍学率为0.3的辍学技术来克服过度。这两个层X1的输出
（3）
之后，使用sigmoid函数来获得标记0和标记1的概率，如方程(4)和(5)所示，
其中p是真概率，q是预测概率。为了简单起见，我们用q(0)表示q(y=0|x2 f c;)，用q(1)表示q(y=1|x2 f c;)。我们的损失函数是样本中所有交叉熵的平均值。假设我们有N个样本，然后通过方程(7)计算损失函数，
我们用反向传播法求出具有模型参数的损耗导数[43]。反向传播是神经网络中训练模型的常用算法。我们遵循与其他研究中所用的相同程序〔44〕。此外，我们使用Adadelta作为优化器，因为它对超参数的选择是鲁棒的[45]。
4。数据
我们用来进行实验的数据包含两个部分。第一部分用于提取医学知识。第二种方法用于青光眼诊断模型的训练。
4.1。领域知识特征生成数据
为了提取光盘区域，我们在包含2000幅图像的人工标记数据集上训练了Faster-RCNN模型。
为了分割视盘区域、视杯区域和PPA区域，我们分别基于包括1000、134和1000个视网膜图像的三个人工标记数据集训练了三个FCN模型。
为了获得RNFLD的特征值，我们基于2000张来自医院的预标记图像训练了一个CNN，包括831张带有RNFLD的图像和1169张没有RNFLD的图像。由于初始图像是从di_erent设备拍摄的，因此它们具有di_erent大小，例如1924*1556、1572*1308和3048*2432。因此，我们需要均衡这些图像的大小。我们将图像裁剪成正方形，然后将其调整为192×192。
4.2。多分支神经网络数据
我们收集了1542例患者的2554张视网膜眼底图像，其中1023张来自青光眼患者，1531张来自非青光眼患者。这些图像具有相应的眼压、病例报告和诊断结果。每个患者都有各种眼病，如白内障和糖尿病视网膜病变。青光眼合并白内障255例，糖尿病视网膜病变173例，近视427例，黄斑变性142例。非青光眼性白内障334例，糖尿病视网膜病变188例，近视365例，黄斑变性137例。我们没有区分青光眼的确切阶段。
类似地，我们首先根据图像的短边将每个图像裁剪成一个正方形。然后我们将正方形图像调整为192×192。数据集的细节总结在表3中。
表3：数据集摘要
5。实验
所有实验均在Ubuntu 14.04.5LTS、2.00GHz Intel(R)Xeon(R)E5-2620CPU和NVIDIA GeForce GTX 1080GPU的工作站上进行。
5.1。视盘检测
我们使用D1进行视盘检测任务。这些图像被随机分成训练集和测试集，比例为4：1。然后，我们基于TensorFlow框架对快速RCNN进行训练，该框架是深层学习领域中流行的框架[46]。我们采用迁移学习来训练模型。
我们使用在ILSVRC 2014中由著名的视觉几何组训练的VGG16权重进行初始化[13]。对于学习率，我们采用分步学习策略（基本学习率为0.001；伽玛为0.1；步长为30000）。
我们使用SGD作为动量为0.9的优化器。我们在测试集上取得了良好的性能。在测试集中的所有400幅视网膜眼底图像中，由于图像质量相对较差，只有8幅图像未被正确检测。在图5中，矩形显示了使用我们训练的Faster-RCNN模型提取的光盘区域。
图5：提取的视盘区域的例子
正如我们所看到的，在最初的三幅图像中，红色矩形精确而完整地覆盖了光盘区域。尤其是第三幅图像不是很清晰，但算法仍然有效。然而，该算法不能在最后一幅图像中找到任何圆盘区域。事实上，这是严重的白内障病例，即使对于专家来说，椎间盘区域也是不可能的。对于失败的情况，我们随机选择一个区域作为光盘图像作为第二分支的输入。
5.2。生成领域知识特征
为了获得RNFLD特征，我们以4：1的比例随机分离2000幅D3图像，形成训练集和测试集。之后，我们对美国有线电视新闻网模型VGG16（13）进行了TensorFlow的调整。对于学习速率，我们采用分步学习策略（基本学习率为0.000001；伽玛为0.1；步长为1000），以SGD为优化器，动量为0.9。RNFLD检测的准确率为90.44%。
图6：PPA、视盘和视杯分割结果的例子
对于特征PPA大小，我们将数据集D2的1000幅图像以0.8的比例分割成训练集和测试集。然后基于张量流对FCN模型进行训练。我们采用亚当优化器来训练模型（1＝0.9，2＝0.999）。学习率设置为0.00001。取得了令人满意的结果，平均精度为84.15%。然后，我们计算PPA区域的大小作为特征PPA大小的值。
对于光盘和光学杯的测量，使用数据集D2和D4分别训练用于光盘区域和光学杯区域分割的FCN模型[47]。两个数据集以0.8的比率被分割成训练集和测试集。然后基于张量流对FCN模型进行训练。参数与PPA区域分割的参数相同。我们获得了满意的结果，光盘的平均精度为90.29％，光杯的平均精度为84.15％。然后计算4个部分的杯对盘比率、视盘大小和杯大小。
图6显示了光盘区域、光杯区域和PPA区域分割结果的示例。第一列显示初始图像。中间显示标签。正确的一个显示结果，其中绿色区域是目标。
5.3。青光眼诊断
以TensorFlow为后端，实现了基于Keras框架[48]的多分支神经网络（MB-NN）模型。我们采用5倍交叉验证来评估模型。我们还使用了数据增强技术，包括随机裁剪、上下颠倒、左右颠倒、随机旋转等。采用Adadelta优化器（学习率为1.0；ρ为0.95；ε为None；衰减为0）对模型进行训练。早期停止技术（最小增量是0.0001；耐心是20）用于避免过度。对于其他深度学习模型进行比较，我们采用同样的技巧。
为了评价我们提出的模型——多分支神经网络（MB-NN）的性能，我们比较了它与三个基准集的性能。该标准集由传统的计算机视觉算法组成，包括基于人工设计特征的logistic回归模型。第二个基准测试集由深度学习模型组成，包括Alexnet[12]、VGG16[13]和inception v3[41]。我们包括第三个基准测试集，包括仅具有所提议模型的两个分支的模型，以测试每个分支的有用性。
5.3.1.基准集1：与传统计算机视觉算法的比较
对于传统的青光眼诊断模型，我们基于旋转不变的局部二进制模式(LBP)、高阶谱(HOS)、离散小波变换(DWT)和尺度不变特征变换(SIFT)特征[24、27、49]连续训练logistic回归模型。我们将它们分别表示为LRLBP、LR HOS、LR DWT和LR SIFT。性能列于表4。
表4：MB神经网络与基准集1模型的比较
从表4可以看出，在基准集1的模型中，MB-NN以0.9151的准确度、0.9233的灵敏度和0.909090的特异性达到最佳性能。我们发现，在基准测试集中，模型的结果并不好，精确度、灵敏度和特殊城市都在0.6左右。这可能是因为这些模型中的特征不能很好地代表青光眼和非青光眼病例的模式。
5.3.2.基准集2：与其他深度学习模型的比较
为了比较所提出模型与其他现有深度学习模型的性能，我们实现了四个著名的模型：AlexNet、VGG16、initionv3，以及Raghavendra等人提出的CNN模型[17]。结果如表5所示。
表5：MB神经网络与基准集2模型的比较
在表5中，在基准集2的所有深度学习模型中，我们提出的模型在准确性、敏感性和特殊性方面都取得了最好的性能。由于在基准集中，我们的模型和模型之间的区别在于我们采用了领域知识，这证明了将领域知识用于青光眼诊断的有效性。
5.3.3。基准集3：敏感性分析
为了验证所提出模型的每个分支的有效性，我们实现了三个两分支模型：不输入整个图像的MB-NN、不输入盘区域的MB-NN和不输入领域知识特征的MB-NN。为了方便起见，我们分别将其称为MB NN 0、MB NN 1和MB NN 2。结果见表6。
表6：MB神经网络与基准集3模型的比较
如表6所示，所有两分支模型的性能都低于完整模型。MB-NN 1的精度为0.8631，灵敏度为0.8597，特异度为0.8657，明显低于MB-NN，表明了光盘区域特征的有效性。其中，MB-NN 2精度为0.8012，灵敏度为0.8175，特异度为0.7840。这表明，领域知识特征能够显著提高性能。
6。讨论
6.1。模型性能
通过实验，我们发现，我们所提出的模型比传统的计算机视觉模型和其他的深度学习模型表现得更好。传统的计算机视觉方法的诊断精度、灵敏度和特异性城市仅为60%，远低于采用相同模型的其他文献（24, 27）所获得的结果。这可能是因为数据是不同的。我们收集了铜仁地区医院的数据，这是中国最好的医院之一。该数据集包括许多具有挑战性和令人困惑的青光眼病例，铜仁地区医院经常接收来自全国各地的各种棘手疾病的患者。此外，不像其他研究中只包含青光眼和正常病例的数据集，我们的数据集包括覆盖各种疾病的非青光眼病例，从而使非青光眼病例的模式更复杂，以供模型学习。此外，一些非青光眼病例与青光眼有相似的症状，这意味着青光眼病例和非青光眼病例具有一些隐藏的模式。我们在图7中显示了一些非青光眼病例。
图7：四例非青光眼病例
从图7中可以看出，虽然这些图像都是非青光眼病例，并且属于数据集中的相同标签，但是它们之间存在明显的差异。另一方面，这些阴性病例与阳性病例有相似之处。例如，PPA出现在高度近视的病例中，这也是青光眼的常见症状，因此使得分类任务更加困难。此外，由于严重的白内障，我们不能清楚地看到一些图像。所有这些因素都使学习任务变得困难，从而影响了模型的性能。
同时，传统的深度学习模型也表现不佳。与区分猫和狗的学习任务相比，由于隐藏的医学模式更加复杂，本文所研究的学习任务更加困难。我们需要更大的数据集来提取有用的特征并获得好的结果。因此，尽管每个类别中的图像数量(2554幅用于两个类别的图像)都大于ILSVRC 2012(每个类别中大约1000幅图像)[12]，但是所学习的特征仍然不够强大，不足以在许多开放式图像分类任务中获得精度。因此，对于实际的青光眼诊断，需要更多的图像。然而，获得贴有标签的医学图像比自然图像要困难得多，特别是对于罕见疾病或场景，其中只能使用特殊或昂贵的设备拍摄医学图像，并且标签只能由少数专家生成。因此，如何利用相对较小的数据集来获得满意的结果，是医学研究中常见的问题。在这种情况下，领域知识是有用的，因为我们更加关注重要领域，我们将领域知识特征与深度学习模型相结合，以获得更好的效果。
6.2。医学含义
首先，该模型可以帮助医生对公民进行青光眼风险评估。青光眼是人类眼睛的主要威胁之一〔1, 2〕。
开角型青光眼，最常见的类型，发展缓慢，没有疼痛，使其很难在恶化前检测。因此，有必要对公民中的可疑病例进行青光眼风险评估。但是，由于医疗资源的限制，这种活动是不可能的。该模型能够实现青光眼的自动诊断，使评价成为可能。
第二，所提出的模型也可以帮助医生提供更好的服务。在医院里，医生需要手动解释医学图像，这既昂贵又容易出错，尤其是当他们疲劳的时候。在这种情况下，所提出的模型可以通过两种方式减轻医生的压力。首先，该模型的诊断结果能够帮助医生做出准确快速的决策。同时，该模型提取的领域知识特征能够帮助医生理解诊断结果，做出更好的决策。因此，该模型能够为医生提供科学、可靠的帮助，从而更好地为医生提供服务。
6.3。研究局限性
研究局限在于两种方式。第一，虽然在青光眼与非青光眼的鉴别中取得了良好的效果，但仍有进一步改进的空间。其次，提出的框架需要训练多个深度学习模型来提取领域知识特征，需要多个标记数据集来训练模型。
7。结论
本文利用医学领域知识设计了一个用于青光眼诊断的多分支神经网络模型。由于光盘区域所包含的信息比其他区域要重要得多，所以我们提取这个区域来单独处理它。我们也注意到医生经常使用一些措施来诊断青光眼。因此，我们在深度学习模型中结合了领域知识特征，如杯盘比、RNFLD、PPA大小以及来自图像和文本的症状。这样，该模型将自动从图像中提取的潜在特征与领域知识特征相结合，提高了准确性和可解释性。为了自动生成这些领域知识特征，我们提出了一个框架来分割相关区域，计算特征值，然后无缝地输入到多分支模型。在实际数据集上的实验表明，我们的模型优于基于传统计算机视觉算法和经典卷积神经网络模型的模型。
未来的研究可以通过两种方式来完成。首先，我们计划扩大实验数据集，以建立一个更深的模型，进一步提高性能。其次，我们计划设计一个FCN，可以同时分割光盘、光杯和PBA，从而进一步节省计算资源。
致谢
这项工作部分由国家自然科学基金（NSFC）资助，编号为71432004, 71771131, 71490724和81700882。北京同仁医院北京同仁医院资深研究生基金会2012-YJJ-GGL—09的基础科学研究基金资助。
工具书类
[1]P.N.Schack.，J.R.样本，《青光眼书：以证据为基础的病人护理实用方法》，Springer Science & Business Media，2010。
[2]
[3]H.A.Quigley，A.T.Broman，2010年和2020年全球青光眼患者的数量，英国眼科学杂志90(3)(2006)262-267。
[4]J.C.贾维特，《预防美国人失明：眼科健康教育的需要》，眼科调查40(1)(1995)41-44。
[5]J.B.Jonas，W.M.Budde，S.Panda-Jonas，视神经头的眼科评价，眼科调查43(4)(1999)293-320。
[6]R.R.B.A.M.B.R.S.P.-J.Jost B.Jonas，Tin Aung，青光眼，柳叶刀标志390(2017)2083-2093。
[7]M.S.Haleem，L..，J.van Hemert，B.Li，用于青光眼诊断的彩色视网膜图像的视网膜特征的自动提取：综述，计算机医学成像和图形37(7)(2013)581-596。
[8]U.Raghavendra，S.V.Bhandary，A.Gudigar，U.R.Acharya，使用具有眼底图像的非参数空间包络能谱的青光眼识别新专家系统，生物控制学和生物医学工程。
〔9〕U. R. Acharya，S. Bhat，J. E. Koh，S. V. Bhandary，H. Adeli，一种新的检测青光眼风险的算法，该方法利用眼底图像中提取的TexTon和局部CONG模式特征，生物学和医学中的计算机88（2017）72～83。
〔10〕K. P. Noronha、U. R. Acharya、K. P. Nayak、R. J. Martis、S. V.
使用高阶累积量特征的青光眼分期的自动分类，生物医学信号处理和控制10(2014)174-183。
[11]Y.LeCun，Y.Bengio，G.Hinton，《深层学习》，自然521(7553)(2015)436。
[12]A.Krizhevsky，I.Sutskever，G.E.Hinton，具有深卷积神经网络的Imagenet分类，见：神经信息处理系统的进展，2012，第1097-1105页。
[13]K.Simonyan，A.Zisserman，用于大规模图像识别的非常深卷积网络，arXiv预印arXiv:1409.1556。
[14]C.Szegedy，W..，Y..，P.Sermanet，S.Reed，D.Anguelov，D.Erhan，V.Vanhoucke，A.Rabinovich，卷积更深，见：IEEE计算机视觉与模式识别会议录，2015，第1-9页。
[15]K.He，X.Zhang，S.Ren，J.Sun，图像识别的深度残差学习，见：IEEE计算机视觉与模式识别会议录，2016，第770-778页。
[16]X..，Y.Xu，S.Yan，D.W.K.Wong，T.Y.Wong，J..，基于深度学习的青光眼检测自动特征学习，见：医学图像计算和计算机辅助干预国际会议，Springer，2015，第669-677页。
[17]U.Raghavendra，H.Fujita，S.V.Bhandary，A.Gudigar，J.H.Tan，U.R.Acharya，用于使用数字眼底图像精确诊断青光眼的深卷积神经网络，信息科学441(2018)41-49。
[18]J.Zilly，J.M.Buhmann，D.Mahapatra，青光眼检测使用熵采样和集成学习进行自动视杯和视盘分割，计算机医学成像和图形55(2017)28-41。
[19]S.M.Shankaranarayana，K.Ram，K.Mitra，M.Sivaprakasam，使用完全卷积和对抗网络的联合光盘和杯分割，见：胎儿、婴儿和眼科医学图像分析，Springer，2017，第168-176页。
〔20〕S. Maheshwari、R. B. Pachori、V. Kanhangad、S. V. Bhandary、美国。
Acharya，基于迭代变分模式分解的自动检测青光眼的眼底图像，计算机在生物学和医学88（2017）142-149。
[21]U.R.Acharya，E.Ng，L.W.J.Eugene，K.P.Noronha，L.C.Min，K.P.Nayak，S.V.Bhandary，使用gabor变换的青光眼决策支持系统，生物医学信号处理和控制15(2015)18-26。
[22]R.Kol_ar，J.Jan，利用分形维数通过彩色眼底图像检测青光眼，放射工程17(3)(2008)109-114。
[23]U.R.Acharya，S.Dua，X.Du，C.K.Chua等，《利用纹理和高阶光谱特征进行青光眼的自动诊断》，IEEE生物医学信息技术交易15(3)(2011)449-455。
[24]M.R.K.Mookiah，U.R.Acharya，C.M.Lim，A.Petznick，J.S.Suri，利用高阶谱和小波能量特征自动诊断青光眼的数据挖掘技术，基于知识的系统33(2012)73-82。
[25]S.Maheshwari，R.B.Pachori，U.R.Acharya，使用经验小波变换和从眼底图像中提取的相关熵特征的青光眼自动诊断，IEEE生物医学和健康信息学杂志，21(3)(2017)803-813。
[26]R.Bock，J.Meier，L.G.Ny_ul，J.Hornegger，G.Michelson，青光眼风险指数：来自彩色眼底图像的自动青光眼检测，医学图像分析14(3)(2010)471-481。
[27]S.Dua，U.R.Acharya，P.Chowriappa，S.V.Sree，青光眼图像分类的基于小波的能量特征，IEEE生物医学信息技术交易16(1)(2012)80-87。
[28]D.Yadav，M.P.Sarathi，M.K.Dutta，基于神经网络纹理特征的青光眼分类，见：当代计算(IC3)，2014年第七届国际会议，IEEE，2014，第109-112页。
[29]J.Nayak，R.Acharya，P.S.B.，N.Shetty，T.-C.Lim，使用数字眼底图像的青光眼自动诊断，医学系统杂志33(5)(2009)337。
[30]T.G.Babu，S.Shenbagadevi，利用眼底图像自动检测青光眼，欧洲科学杂志研究59(1)(2011)22-32。
[31]S.Lee，K.Kim，J.Seo，D.Kim，H.Chung，K.Park，H.Kim，眼底照片中视网膜神经-视网膜层萎缩的自动定量，刊于：医学和生物学会工程，2004年。iEMBS '04。IEEE第二十六届国际年会，第1卷，IEEE，2004，PP。
1241—1243。
[32]S.Chaudhuri，视网膜图像中视神经的自动检测，在：Proc.图像处理，1989，第15, 1989卷。
[33]M.Lalonde，M.Beaulieu，L.Gagnon，使用金字塔分解和基于hausdor的模板匹配的快速和鲁棒的光盘检测，IEEE医学成像事务20(11)(2001)1193-1200。
[34]S.Ren，K.He，R.Girshick，J.Sun，Faster r-cnn：用区域建议网络实现实时对象检测，见：神经信息处理系统的进展，2015，第91-99页。
[35]C.Farabet，C.Couprie，L.Na jman，Y.LeCu，学习用于场景标记的分层特征，模式分析上的IEEE事务和机器智能35(8)(2013)1915-1929。
[36]H.Li，M.R.M in，Y.Ge，A.Kadav，用于交互式问题回答的上下文感知注意网络，见：第23届ACM SIGKDD知识发现和数据挖掘国际会议记录，ACM，2017，第927-935页。
[37]A.Graves，A.-r.Mohamed，G.Hinton，用深度递归神经网络进行语音识别，见：声学、语音和信号处理(icassp)，2013年ieee国际会议，IEEE，2013，第6645-6649页。
[38]Y.Hatanaka，A.Noudo，C.Muramatsu，A.Sawada，T.Hara，T.Yamamoto，H.Fujita，基于视网膜图像中直线prole分析的杯盘比率的自动测量，见：医学和生物学会工程，EMBC，2011年IEEE国际年会，IEEE，2011，pp3387—3390。
[39]V..azi，J.Keltner，C.Johnson，青光眼视杯的计算机分析，研究性眼科和视觉科学26(12)(1985)1759-1770。
[40]J..，E.Shelhamer，T.Darrell，用于语义分割的全卷积网络，见：计算机视觉和模式识别IEEE会议记录，2015，第3431-3440页。
[41]C.Szegedy，V.Vanhoucke，S.Io_e，J.Shlens，Z.Wo jna，重新思考计算机视觉的起始架构，见：IEEE计算机视觉与模式识别会议记录，2016，第2818-2826页。
[42]P.T.De Boer，D.P.Kr.e，S.Man.，R.Y.Rubinstein，交叉熵方法教程，运筹学年鉴134(1)(2005)19-67。
[43]Y.Chauvin，D.E.Rumelhart，《反向传播：理论、体系结构和应用》，心理学出版社，1995。
[44]Y.LeCu，B.Boser，J.S.Denker，D.Henderson，R.E.Howard，W.Hubbard，L.D.Jackel，应用于手写邮政编码识别的反向传播，神经计算1(4)(1989)541-551。
[45]M.D.Zeiler，Adadelta：自适应学习速率方法，arXiv预打印arXiv:1212.5701。
〔46〕M. Abadi、A. Agarwal、P. Barham、E. Brevdo、Z. Chen、C. Citro、G. S.
Corrado，A.Davis，J.Dean，M.Devin等，Tensorow：异构分布式系统上的大规模机器学习，arXiv预打印arXiv：1603.04467。
[47]M.Teichmann,M.Weber,M.Zoellner,R.Cipolla,R.Urtasun,Multinet:用于自主驾驶的实时联合语义推理,arXiv预印arXiv:1612.07695。
〔48〕F. Chollet，等，Kalas（2015）。
[49]D.G.Lowe，《来自比例不变关键点的独特图像特征》，国际计算机视觉杂志60(2)(2004)91-110。
